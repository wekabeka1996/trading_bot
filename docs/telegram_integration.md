# Telegram Bot Integration - Документація

## Нова функціональність

### 1. Зміни в плані
- **Час торгів змінено**: відкриття о 20:30, закриття о 21:30
- **Автоматичне закриття позицій** при завершенні торгової сесії

### 2. Telegram Bot з командами

#### Команди управління:
- `/start` - перезапуск бота та показ команд
- `/status` - поточний статус бота, план, баланс
- `/stop_trading` - зупинити всі торгові операції
- `/close_all` - закрити всі позиції та скасувати ордери

#### Команди інформації:
- `/positions` - показати всі відкриті позиції
- `/balance` - показати баланс рахунку
- `/help` - показати всі доступні команди

### 3. Трансляція логів
- **Всі логи бота автоматично надсилаються в Telegram**
- Фільтруються спам-повідомлення (HTTP requests, heartbeat)
- Відправляються тільки логи рівня INFO і вище
- Кожне повідомлення має часову мітку та іконку за рівнем

### 4. Безпека
- **Kill-switch функції**: автоматична зупинка при критичних втратах
- **Emergency stop**: через команду `/stop_trading`
- **Force close**: через команду `/close_all`

## Приклад використання

1. **Запуск бота**:
   ```bash
   python main.py
   ```

2. **Отримання статусу через Telegram**:
   - Надішліть `/status` в чат з ботом
   - Отримаєте інформацію про план, баланс, час

3. **Екстрена зупинка**:
   - Надішліть `/stop_trading` для зупинки торгів
   - Надішліть `/close_all` для закриття всіх позицій

4. **Моніторинг**:
   - Всі логи будуть автоматично транслюватися в чат
   - Отримаєте сповіщення про входи/виходи з позицій
   - Попередження про ризики та помилки

## Технічні деталі

### Архітектура:
- `TradingTelegramBot` - основний клас бота з командами
- `TelegramLogHandler` - обробник для трансляції логів
- Інтеграція в `main.py` з автоматичним запуском
- Робота в окремому потоці для неблокуючого виконання

### Залежності:
- `python-telegram-bot` - для роботи з Telegram API
- `asyncio` - для асинхронної роботи бота
- `threading` - для роботи в окремому потоці

### Конфігурація в .env:
```
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here
```

## Безпека та обмеження

1. **Авторизація**: тільки вказаний chat_id може виконувати команди
2. **Фільтрація логів**: спам-повідомлення не транслюються
3. **Graceful shutdown**: правильне завершення всіх компонентів
4. **Error handling**: помилки Telegram не впливають на торгівлю
